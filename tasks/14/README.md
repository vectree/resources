# Таймеры

Микроконтроллеры серии STM32 имеют около 10 таймером. Первым таймером, которым вы уже неявно пользовались в предыдущих лабораторных работах является system timer, который присутствует практически во всех ARM Cortex-M процессорах. По умолчанию CubeMX настраивает данный таймер на генерацию прерываний с частотой 1 кГц. А код обработчика прерывания просто выполняет инкремент переменной `uwTick` библиотеки HAL.

```cpp
void SysTick_Handler(void)
{
    HAL_IncTick();
    HAL_SYSTICK_IRQHandler();
}

...

__weak void HAL_IncTick(void)
{
    uwTick++;
}

...
```
и с помощью данной переменной реализуется функция HAL_Delay, которую вы использовали паузы:

```cpp
__weak void HAL_Delay(__IO uint32_t Delay)
{
  uint32_t tickstart = HAL_GetTick();
  while((HAL_GetTick() - tickstart) < Delay) {}
}

...

__weak uint32_t HAL_GetTick(void)
{
  return uwTick;
}
 
...
```

Кроме данного таймера у STM32F3 так же имеются таймеры TIM1, TIM2, TIM3, TIM4, TIM6, TIM7, TIM8, TIM15, TIM16, TIM17. Данные таймеры облают большими возможностями чем system timer и имеют следующие возможности:
1) генерация прерываний с заданной частотой
2) измерение длительности сигналов
3) генерация сигнала с широтно-импульсной модуляцией (PWM), которая
используется для управления большим количеством периферии. Например, c помощью широтно-импульсной модуляции управляются сервоприводы и бесколлекторные двигатели. Пример таких сигналов приведен на рисунке 1.

![Alt text](https://sun9-7.userapi.com/c840532/v840532538/51d97/XWpJBLlz5zE.jpg)

Рисунок 1. Пример сигналов с широтно-импульсной модуляцией

## Задание

* Шаг #1: Таймеры STM32
* Шаг #2: PWM модуляция. Управление сервоприводом
* Шаг #3: Измерение длительности сигнала на примере ультразвукового сенсора HC-SR04
